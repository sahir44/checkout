<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Checkout - Product Details</title>
    <style>
        :root{--bg:#f6f8fb;--card:#fff;--accent:#0b66ff;--muted:#6b7280;--success:#16a34a}
        *{box-sizing:border-box;font-family:Inter,Segoe UI,system-ui,Roboto,"Helvetica Neue",Arial}
        body{margin:0;background:var(--bg);color:#0f172a;padding:28px}
        .container{max-width:1100px;margin:0 auto;display:grid;grid-template-columns:1fr 360px;gap:24px}
        header{display:flex;justify-content:space-between;align-items:center;margin-bottom:18px}
        h1{font-size:20px;margin:0}
        .card{background:var(--card);border-radius:10px;padding:18px;box-shadow:0 6px 18px rgba(12,18,26,0.06)}
        .products{display:flex;flex-direction:column;gap:12px}
        .product{display:flex;gap:12px;align-items:center;padding:12px;border-radius:8px;border:1px solid #eef2f7}
        .thumb{width:88px;height:88px;border-radius:8px;background:linear-gradient(135deg,#e6eefc,#f9fafb);display:flex;align-items:center;justify-content:center;color:#0b66ff;font-weight:700}
        .meta{flex:1}
        .meta h3{margin:0;font-size:15px}
        .meta p{margin:6px 0 0;font-size:13px;color:var(--muted)}
        .price{font-weight:700}
        .controls{display:flex;align-items:center;gap:10px;margin-left:auto}
        input[type=number]{width:68px;padding:6px;border-radius:8px;border:1px solid #e6edf7;text-align:center}
        .remove{background:transparent;color:#ef4444;border:0;cursor:pointer;font-size:13px}
        form .section{margin-bottom:12px}
        label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
        input[type=text],input[type=email],select{width:100%;padding:10px;border-radius:8px;border:1px solid #e6edf7;background:#fff}
        .two{display:grid;grid-template-columns:1fr 1fr;gap:10px}
        .summary{position:sticky;top:24px}
        .summary h2{font-size:16px;margin:0 0 12px}
        .row{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px dashed #eef2f7;font-size:14px}
        .total{font-weight:800;font-size:18px;padding-top:8px}
        .coupon{display:flex;gap:8px;margin-top:8px}
        .btn{background:var(--accent);color:#fff;padding:11px 14px;border:0;border-radius:9px;cursor:pointer;font-weight:600}
        .btn.secondary{background:#fff;border:1px solid #e6edf7;color:#0f172a}
        .note{font-size:13px;color:var(--muted)}
        .success{display:none;padding:12px;border-radius:8px;background:rgba(22,163,74,0.08);color:var(--success);margin-top:12px}
        @media (max-width:980px){.container{grid-template-columns:1fr;padding:0 12px}}
    </style>
</head>
<body>
    <header>
        <h1>Checkout</h1>
        <div class="note">Secure checkout • SSL encrypted</div>
    </header>

    <main class="container">
        <!-- Left: Product list + billing + payment -->
        <div>
            <section class="card">
                <h2 style="margin:0 0 12px">Order details</h2>
                <div class="products" id="cart">
                    <!-- product item -->
                    <div class="product" data-price="59.99" data-id="sku-001">
                        <div class="thumb" aria-hidden="true">P</div>
                        <div class="meta">
                            <h3>Premium Wireless Headphones</h3>
                            <p class="note">Noise-cancelling, 30h battery • SKU: SKU-001</p>
                            <div style="margin-top:6px" class="price">$59.99</div>
                        </div>
                        <div class="controls">
                            <input type="number" min="1" value="1" class="qty" aria-label="Quantity">
                            <button class="remove" type="button" title="Remove item">Remove</button>
                        </div>
                    </div>

                    <!-- second product example -->
                    <div class="product" data-price="24.50" data-id="sku-002">
                        <div class="thumb" aria-hidden="true">C</div>
                        <div class="meta">
                            <h3>Carrying Case</h3>
                            <p class="note">Compact protective case • SKU: SKU-002</p>
                            <div style="margin-top:6px" class="price">$24.50</div>
                        </div>
                        <div class="controls">
                            <input type="number" min="1" value="1" class="qty" aria-label="Quantity">
                            <button class="remove" type="button" title="Remove item">Remove</button>
                        </div>
                    </div>
                </div>
            </section>

            <form id="checkoutForm" class="card" novalidate>
                <h2 style="margin:0 0 12px">Billing details</h2>

                <div class="section two">
                    <div>
                        <label for="fullname">Full name</label>
                        <input id="fullname" name="fullname" type="text" required placeholder="Jane Doe">
                    </div>
                    <div>
                        <label for="email">Email</label>
                        <input id="email" name="email" type="email" required placeholder="you@example.com">
                    </div>
                </div>

                <div class="section">
                    <label for="address">Address</label>
                    <input id="address" name="address" type="text" required placeholder="Street address, apartment, etc.">
                </div>

                <div class="section two">
                    <div>
                        <label for="city">City</label>
                        <input id="city" name="city" type="text" required>
                    </div>
                    <div>
                        <label for="zip">ZIP / Postal</label>
                        <input id="zip" name="zip" type="text" required>
                    </div>
                </div>

                <div class="section two">
                    <div>
                        <label for="country">Country</label>
                        <select id="country" name="country" required>
                            <option value="">Select country</option>
                            <option>United States</option>
                            <option>Canada</option>
                            <option>United Kingdom</option>
                        </select>
                    </div>
                    <div>
                        <label for="phone">Phone</label>
                        <input id="phone" name="phone" type="text" placeholder="+1 555 5555">
                    </div>
                </div>

                <h2 style="margin:12px 0">Payment</h2>
                <div class="section">
                    <label>Method</label>
                    <div style="display:flex;gap:12px">
                        <label style="display:flex;align-items:center;gap:8px">
                            <input type="radio" name="method" value="card" checked> Card
                        </label>
                        <label style="display:flex;align-items:center;gap:8px">
                            <input type="radio" name="method" value="paypal"> PayPal
                        </label>
                    </div>
                </div>

                <div id="cardDetails">
                    <div class="section">
                        <label for="card">Card number</label>
                        <input id="card" name="card" type="text" inputmode="numeric" placeholder="4111 1111 1111 1111" maxlength="19" required>
                    </div>
                    <div class="section two">
                        <div>
                            <label for="expiry">Expiry (MM/YY)</label>
                            <input id="expiry" name="expiry" type="text" placeholder="08/26" maxlength="5" required>
                        </div>
                        <div>
                            <label for="cvc">CVC</label>
                            <input id="cvc" name="cvc" type="text" inputmode="numeric" maxlength="4" required>
                        </div>
                    </div>
                </div>

                <div style="display:flex;gap:8px;align-items:center;margin-top:8px">
                    <button type="submit" class="btn">Place order</button>
                    <button type="button" class="btn secondary" id="saveDraft">Save draft</button>
                </div>

                <div id="message" class="success" role="status" aria-live="polite"></div>
            </form>
        </div>

        <!-- Right: Order summary -->
        <aside class="summary card">
            <h2>Order summary</h2>
            <div id="summaryList"></div>
            <div class="row"><div>Subtotal</div><div id="subtotal">$0.00</div></div>
            <div class="row">
                <div>Shipping</div>
                <div>
                    <select id="shipping">
                        <option value="0">Standard — Free</option>
                        <option value="5.99">Express — $5.99</option>
                    </select>
                </div>
            </div>
            <div class="row"><div>Tax (8%)</div><div id="tax">$0.00</div></div>

            <div class="coupon">
                <input id="coupon" placeholder="Coupon code" style="flex:1;padding:8px;border-radius:8px;border:1px solid #e6edf7">
                <button id="applyCoupon" class="btn secondary">Apply</button>
            </div>

            <div class="row total">
                <div>Total</div>
                <div id="total">$0.00</div>
            </div>
            <div class="note" style="margin-top:8px">You won't be charged yet. This is a preview of your order.</div>
        </aside>
    </main>

    <script>
        // Minimal cart logic: update totals, quantity, remove items, apply coupon, validate form
        const cartEl = document.getElementById('cart');
        const summaryList = document.getElementById('summaryList');
        const subtotalEl = document.getElementById('subtotal');
        const taxEl = document.getElementById('tax');
        const totalEl = document.getElementById('total');
        const shippingSel = document.getElementById('shipping');
        const couponInput = document.getElementById('coupon');
        const applyCoupon = document.getElementById('applyCoupon');
        const message = document.getElementById('message');
        let discount = 0;

        function format(n){return '$'+n.toFixed(2)}

        function getItems(){
            return Array.from(cartEl.querySelectorAll('.product')).map(p=>{
                const price = parseFloat(p.dataset.price||0);
                const qty = Math.max(1, parseInt(p.querySelector('.qty').value||1));
                const title = p.querySelector('h3').textContent.trim();
                return {el:p,price,qty,title};
            });
        }

        function renderSummary(){
            const items = getItems();
            summaryList.innerHTML = '';
            let subtotal=0;
            items.forEach(i=>{
                subtotal += i.price * i.qty;
                const d = document.createElement('div');
                d.style.display='flex';d.style.justifyContent='space-between';d.style.padding='6px 0';
                d.innerHTML = `<div style="color:#374151">${i.title} × ${i.qty}</div><div style="font-weight:600">${format(i.price*i.qty)}</div>`;
                summaryList.appendChild(d);
            });
            subtotalEl.textContent = format(subtotal);
            const tax = subtotal * 0.08;
            taxEl.textContent = format(tax);
            const shipping = parseFloat(shippingSel.value||0);
            let total = subtotal + tax + shipping - discount;
            if(total < 0) total = 0;
            totalEl.textContent = format(total);
        }

        // initial render
        renderSummary();

        // event delegation: quantity change and remove
        cartEl.addEventListener('input', e=>{
            if(e.target.classList.contains('qty')){
                if(e.target.value === '' || parseInt(e.target.value) < 1) e.target.value = 1;
                renderSummary();
            }
        });

        cartEl.addEventListener('click', e=>{
            if(e.target.classList.contains('remove')){
                const product = e.target.closest('.product');
                if(product) product.remove();
                renderSummary();
            }
        });

        shippingSel.addEventListener('change', renderSummary);

        applyCoupon.addEventListener('click', ()=>{
            const code = (couponInput.value||'').trim().toUpperCase();
            if(code === 'SAVE10'){
                discount = 10;
                applyCoupon.textContent = 'Applied';
                applyCoupon.disabled = true;
                couponInput.disabled = true;
            } else {
                discount = 0;
                alert('Invalid coupon. Try "SAVE10".');
            }
            renderSummary();
        });

        // toggle card fields based on payment method
        document.querySelectorAll('input[name="method"]').forEach(r=>{
            r.addEventListener('change', ()=> {
                document.getElementById('cardDetails').style.display = (r.value === 'card' && r.checked) ? 'block' : 'none';
            });
        });

        // simple card format helper
        const cardInput = document.getElementById('card');
        cardInput.addEventListener('input', e=>{
            let v = e.target.value.replace(/\D/g,'').slice(0,16);
            v = v.match(/.{1,4}/g)?.join(' ') || v;
            e.target.value = v;
        });

        // expiry formatting
        const expiry = document.getElementById('expiry');
        expiry.addEventListener('input', e=>{
            let v = e.target.value.replace(/\D/g,'').slice(0,4);
            if(v.length>=3) v = v.slice(0,2) + '/' + v.slice(2);
            e.target.value = v;
        });

        // form submit: validate minimal fields and show success
        document.getElementById('checkoutForm').addEventListener('submit', function(evt){
            evt.preventDefault();
            const form = evt.target;
            // basic validity
            if(!form.reportValidity()) return;
            const items = getItems();
            if(items.length === 0){ alert('Your cart is empty.'); return; }
            // show confirmation (simulate server call)
            message.style.display = 'block';
            message.textContent = 'Processing payment...';
            setTimeout(()=> {
                message.textContent = 'Payment successful — thank you for your purchase!';
                // reset coupon button after purchase
                applyCoupon.disabled = true;
            }, 900);
        });

        // save draft: store minimal in localStorage
        document.getElementById('saveDraft').addEventListener('click', ()=>{
            const snapshot = {
                items: getItems().map(i=>({id:i.el.dataset.id,qty:i.qty})),
                billing: {
                    fullname: document.getElementById('fullname').value,
                    email: document.getElementById('email').value
                }
            };
            localStorage.setItem('checkoutDraft', JSON.stringify(snapshot));
            alert('Draft saved locally.');
        });

        // load draft if present
        (function loadDraft(){
            try{
                const d = JSON.parse(localStorage.getItem('checkoutDraft')||'null');
                if(d && d.billing){
                    document.getElementById('fullname').value = d.billing.fullname || '';
                    document.getElementById('email').value = d.billing.email || '';
                }
            }catch(e){}
        })();
    </script>
</body>
</html>